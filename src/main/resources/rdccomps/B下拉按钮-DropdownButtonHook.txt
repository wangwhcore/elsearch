"<s1>Human:RDC中页面:列表 组件名称:DropdownButtonHook 业务名称: "启用/停用",B下拉按钮 组件,元属性/元数据怎么编写？</s1>
<s1>Assisnt:元数据内容如下:
```
{"type":"DropdownButtonHook","property":{"commonProperty":[],"size":"default","enabled":true,"componentTypeName":"","dataSource":"[\n  {\n     text:\"$${button.enable}\",\n     key:\"bg_budgetprojtype_enable\" \n  },\n   {\n     text:\"$${button.disable}\",\n     key:\"bg_budgetprojtype_disable\" \n  },\n]","anchorTarget":false,"subscribes":[{"event":"8967f70a70aa44a8b67fd3e0bd1c9846.onClick","pubs":[{"event":"f465ba09c03d4c70b4353c0d7ef0e5a1.","eventPayloadExpression":"pubsub.publish(\"f465ba09c03d4c70b4353c0d7ef0e5a1.dataContext\", eventPayload)"}],"behaviors":[{"type":"request","dataSource":{"type":"api","serverName":"budget","method":"post","bodyExpression":"resolveFetch({ fetch: { id: '0634e74625a44a02ad1b0d2b520c3c1e', data: 'selectedRows' } }).then(rows=> {\r\n  if (rows && rows.length > 0) {\r\n    let aGids = []\r\n    let data = ''\r\n    if(eventPayload==1){\r\n        data = 'enable'\r\n    }else{\r\n        data='disable'\r\n    }\r\n    aGids = rows.map(item => item.budgetProjTypeId )\r\n    callback({ids:aGids.join(',')},`/bgbudgetprojtype/${data}`)\r\n  }else{\r\n      pubsub.publish('@@message.error', \"$${common.valid.please.select.at.least.one.piece.of.data}\")\r\n  }\r\n})"},"successPubs":[{"pageId":"global","event":"@@message.handleMsg","eventPayloadExpression":"callback(response)","name":"成功之后提醒消息"},{"event":"f465ba09c03d4c70b4353c0d7ef0e5a1.reload","name":"请求成功刷新列表","eventPayloadExpression":""}],"errorPubs":[{"event":"","eventPayloadExpression":"pubsub.publish('@@message.error', eventPayload||'$${message.submit.failure}')"}]}],"rules":[]}],"theme":"","valueField":"key","styleType":"1","border":"all","ghost":false,"visible":true,"actionList":[{"id":"8e6e6b84ceff41ccbe6b8a2ab58aad7e","key":"bg_budgetprojtype_enable","name":"$${button.enable}","actionId":"bg_budgetprojtype_enable","functionId":""},{"id":"a800774f7b3948b188afe55b9fe519c0","key":"bg_budgetprojtype_disable","name":"$${button.disable}","actionId":"bg_budgetprojtype_disable","functionId":""}],"tagStyle":"{display:'inline-block',marginLeft:'4px'}","displayField":"text","title":"$${button.enable.disable}","icon":"down","type":"default","id":"8967f70a70aa44a8b67fd3e0bd1c9846","description":"启用/停用","propType":"DropdownButtonHook","isTitleChange":false}}
```
</s1>"
"<s1>Human:RDC中页面:定标-查看 组件名称:DropdownButtonHook 业务名称: "寻源报告",B下拉按钮 组件,元属性/元数据怎么编写？</s1>
<s1>Assisnt:元数据内容如下:
```
{"type":"DropdownButtonHook","property":{"size":"default","enabled":true,"componentTypeName":"","dataSource":"// 按物料是1。按供应商是2\n[{ val: '$${label.byMaterial}', key: 1 }, { val: \"$${label.byVendor}\", key: 2 }]","subscribes":[{"event":"96944635a5004055b9f4f0df29bf787f.onClick","pubs":[{"event":"","eventPayloadExpression":"resolveFetch({ fetch: { id: \"190369fa3cf94f3dbc3acb8e8f42319f\", data: \"@@formValues\" } }).then(function (result) {\n    let params = `bidSureId=${result.bidSureId}`\n\n    let url = eventPayload == 1 ? `/bidsure/exportsourcebym?${params}` : `/bidsure/exportsourcebyv?${params}`\n    var dataSource = {\n        method: \"get\",\n        type: \"api\",\n        serverName: \"bidding\",\n        url\n    };\n    // debugger\n    resolveDataSource({ dataSource: dataSource, isContentType: false, isReturnResponse: true }).then((response) => {\n        response.blob().then((blob) => {\n            let a = document.createElement('a');\n            let url = window.URL.createObjectURL(blob);\n            a.href = url;\n            let fileName = '$${RFQ.label.sourcingReport}（' + (eventPayload == 1 ? '物料' : '供应商') + '）-' + result.bidSureNo + '.xls';\n            if (response.headers.get('content-disposition')) {\n                // fileName = window.decodeURIComponent(response.headers.get('content-disposition').split('=')[1], 'UTF-8')\n            }\n            a.download = fileName;\n            // debugger\n            a.click();\n            window.URL.revokeObjectURL(url);\n        })\n    });\n});\n"}]},{"event":"96944635a5004055b9f4f0df29bf787f.","behaviors":[{"type":"request","dataSource":{"type":"api","serverName":"bidding","method":"get","url":"/bidsure/exportsourcebym","bodyExpression":"// Type you code ...\nresolveFetch({ fetch: { id: \"190369fa3cf94f3dbc3acb8e8f42319f\", data: \"@@formValues\" } }).then(function (result) {\n    callback({\n        bidSureId: result.bidSureId\n    })\n});"},"successPubs":[{"event":"","eventPayloadExpression":"\nlet respon = JSON.parse(eventPayload)\ndebugger\neventPayload.blob().then((blob) => {\n    let a = document.createElement('a');\n    let url = window.URL.createObjectURL(blob);\n    a.href = url;\n    let fileName = '模板.xls';\n    if (response.headers.get('content-disposition')) {\n        fileName = window.decodeURIComponent(response.headers.get('content-disposition').split('=')[1], 'UTF-8')\n    }\n    a.download = fileName;\n    a.click();\n    window.URL.revokeObjectURL(url);\n})"}]}]},{"event":"96944635a5004055b9f4f0df29bf787f.","pubs":[{"event":"","eventPayloadExpression":"resolveFetch({ fetch: { id: \"190369fa3cf94f3dbc3acb8e8f42319f\", data: \"@@formValues\" } }).then(function (result) {\n    let a = document.createElement('a');\n    let api = window.domainUrl + 'bidding/bidsure/exportsourcebym'\n    let query = `?bidSureId=${result.bidSureId}`\n    let url = api + query\n    a.href = url\n    a.download = '测试.xls'\n    // debugger\n    a.click()\n\n    // let url = window.URL.createObjectURL(blob);\n    // a.href = url;\n    // let fileName = '模板.xls';\n    // if (response.headers.get('content-disposition')) {\n    //     fileName = window.decodeURIComponent(response.headers.get('content-disposition').split('=')[1], 'UTF-8')\n    // }\n    // a.download = fileName;\n    // a.click();\n    // window.URL.revokeObjectURL(url); \n});"}]}],"theme":"","valueField":"key","styleType":"1","border":"all","ghost":false,"visible":false,"actionList":[],"tagStyle":"{display:'inline-block',float:'left'}","displayField":"val","title":"$${RFQ.label.sourcingReport}","icon":"down","type":"default","id":"96944635a5004055b9f4f0df29bf787f","description":"寻源报告","propType":"DropdownButtonHook","isTitleChange":false}}
```
</s1>"
"<s1>Human:RDC中页面:列表 组件名称:DropdownButtonHook 业务名称: "上架/下架",B下拉按钮 组件,元属性/元数据怎么编写？</s1>
<s1>Assisnt:元数据内容如下:
```
{"property":{"size":"default","enabled":false,"componentTypeName":"","dataSource":"[\n    { key: \"1\", val: \"$${button.uppersheff}\", enabled: true }, \n    { key: \"2\", val: \"$${button.lowersheff}\", enabled: true }\n]","subscribes":[{"pubs":[{"event":"","eventPayloadExpression":"resolveFetch({ fetch: { id: '3310215d44724fa29d4b0bacf0164c61', data: 'selectedRows' } }).then(result => {\n  \n  console.log('123')\n  \n  const goodsCodeList = [];\n  result.forEach(item => goodsCodeList.push(item.goodsCode));\n  //1 上架  2 下架\n  if (eventPayload == 1) {\n    pubsub.publish('4956686bbee44fc9824e1904197fbaad.upper', { goodsCodeList });\n  } else if (eventPayload == 2) {\n    pubsub.publish('4956686bbee44fc9824e1904197fbaad.down', { goodsCodeList });\n  }\n})"}],"event":"4956686bbee44fc9824e1904197fbaad.onClick"},{"behaviors":[{"type":"request","errorPubs":[{"pageId":"global","event":"@@message.error","eventPayloadExpression":"callback(eventPayload)"}],"successPubs":[{"pageId":"global","event":"@@message.handleMsg","eventPayloadExpression":"callback(response)"},{"event":"3310215d44724fa29d4b0bacf0164c61.loadData","eventPayloadExpression":""}],"dataSource":{"method":"post","serverName":"csm","bodyExpression":"callback(eventPayload)","type":"api","url":"/csmgoods/upper"}}],"name":"上架","event":"4956686bbee44fc9824e1904197fbaad.upper"},{"behaviors":[{"type":"request","errorPubs":[{"pageId":"global","event":"@@message.error","eventPayloadExpression":"callback(eventPayload)"}],"successPubs":[{"pageId":"global","event":"@@message.handleMsg","eventPayloadExpression":"callback(response)"},{"event":"3310215d44724fa29d4b0bacf0164c61.loadData"}],"dataSource":{"method":"post","serverName":"csm","bodyExpression":"callback(eventPayload)","type":"api","url":"/csmgoods/down"}}],"name":"下架","event":"4956686bbee44fc9824e1904197fbaad.down"}],"theme":"","valueField":"key","styleType":"1","border":"all","ghost":false,"visible":true,"actionList":[{"functionId":"","name":"$${button.uppersheff}","actionId":"csm_goods_up","id":"738c2f83a1b3470db5a0710ac638b48d","key":"1"},{"functionId":"","name":"$${button.lowersheff}","actionId":"csm_goods_up","id":"dafe78c16cd54b9aaac085c985ce9d3b","key":"2"}],"tagStyle":"{display:'inline-block',marginLeft:'4px'}","displayField":"val","title":"$${button.uppersheff}/$${button.lowersheff}","icon":"down","type":"default","id":"4956686bbee44fc9824e1904197fbaad","description":"上架/下架","propType":"DropdownButtonHook","isTitleChange":false},"type":"DropdownButtonHook"}
```
</s1>"
"<s1>Human:RDC中页面:查看 组件名称:DropdownButtonHook 业务名称: "合同比对",B下拉按钮 组件,元属性/元数据怎么编写？</s1>
<s1>Assisnt:元数据内容如下:
```
{"type":"DropdownButtonHook","property":{"size":"default","enabled":true,"componentTypeName":"","dataSource":"[]","subscribes":[{"event":"c0f14154163340a1b1e6d7c9df4476ff.onClick","pubs":[{"event":"","eventPayloadExpression":"// 当前选中类型selectType\r\npubsub.publish(\"@@form.change\", {\r\n    id: \"ae215f50afa74b59a1ed339b7e9a3fc6\",\r\n    name: 'selectType',\r\n    value: eventPayload\r\n});\r\n// 清除比对标识\r\npubsub.publish('@@form.change', { id: 'ae215f50afa74b59a1ed339b7e9a3fc6', name: 'comparsion', value: false });\r\nresolveFetch({ fetch: { id: \"ae215f50afa74b59a1ed339b7e9a3fc6\", data: \"@@formValues\" } }).then(function (result) {\r\n    console.log(result)\r\n    // 系统比对文件-当前合同正文\r\n    let targetFileUrl = localStorage.systemDomain + '/gateway/console/fs/file/download?fileCode='\r\n    let targetFName = result.contractName + '_' + result.contractNo + '_' + result.ctcHstVerNo + '.pdf'\r\n    // 系统原文件-合同模板正文\r\n    let orgFileUrl = localStorage.systemDomain + '/gateway/console/fs/file/download?fileCode='\r\n    let orgFName = result.templateName + '_' + result.templateNo + '.pdf'\r\n    // let url = '';\r\n    if (eventPayload === 'temp') {//合同模板比对\r\n        // url = '/ctccontract/replacetemplatecontent';\r\n        pubsub.publish(\"853a93099fd846b0a53dd0b586c6d202.setHtml\", {})\r\n        // 系统比对文件-当前合同正文\r\n        targetFileUrl += result.contentFileCode\r\n        pubsub.publish(\"853a93099fd846b0a53dd0b586c6d202.setTargetData\", { name: targetFName, url: targetFileUrl })\r\n\r\n        // 系统原文件-合同模板正文\r\n        orgFileUrl += result.tempContentFileCode\r\n        setTimeout(() => {\r\n            // pubsub.publish(\"853a93099fd846b0a53dd0b586c6d202.setOrgData\",{name:orgFName, url:orgFileUrl})\r\n        }, 500)\r\n    } else if (eventPayload === 'history') {//修改前合同比对\r\n        // url = '/ctccontract/replacehistorycontent';\r\n        pubsub.publish(\"853a93099fd846b0a53dd0b586c6d202.setHtml\", {})\r\n        // 系统比对文件-当前合同正文\r\n        targetFileUrl += result.contentFileCode\r\n        // pubsub.publish(\"853a93099fd846b0a53dd0b586c6d202.setTargetData\",{name:targetFName, url:targetFileUrl})\r\n\r\n        // 系统原文件-上一个版本合同正文\r\n        if (result.contractHistoryList && result.contractHistoryList.length > 1) {\r\n            let ctcHst = result.contractHistoryList[result.contractHistoryList.length - 2]\r\n            let fileCode = ctcHst.contentFileCode\r\n            orgFileUrl += fileCode\r\n            pubsub.publish(\"853a93099fd846b0a53dd0b586c6d202.setHtml\", {})\r\n            orgFName = ctcHst.contractName + '_' + ctcHst.contractNo + '_' + ctcHst.ctcHstVerNo + '.pdf'\r\n            // setTimeout(() => {\r\n            // pubsub.publish(\"853a93099fd846b0a53dd0b586c6d202.setOrgData\",{name:orgFName, url:orgFileUrl})\r\n            // }, 500)\r\n        }\r\n        setTimeout(() => {\r\n            // 先设置setTargetData的话，比对文件的名称显示不出来。待后面组件看原因\r\n            pubsub.publish(\"853a93099fd846b0a53dd0b586c6d202.setTargetData\", { name: targetFName, url: targetFileUrl })\r\n        }, 500)\r\n    }\r\n    if (eventPayload === 'other') {//其他文件比对\r\n        let fileUrl = localStorage.systemDomain + '/gateway/console/fs/file/download?fileCode=' + result.contentFileCode;\r\n        let fileName = result.contractName + '_' + result.contractNo + '_' + result.ctcHstVerNo + '.pdf';\r\n        pubsub.publish(\"853a93099fd846b0a53dd0b586c6d202.setHtml\", {})\r\n        pubsub.publish(\"853a93099fd846b0a53dd0b586c6d202.setTargetData\", { name: fileName, url: fileUrl })\r\n    }\r\n});"}],"index":0}],"theme":"","valueField":"code","styleType":"1","border":"all","ghost":false,"visible":true,"actionList":[{"id":"f79254fd17984f8d8b767ee3e1d4265b","actionId":"contract_replacetemplatecontent","functionId":"","name":"合同模板比对","key":"temp"},{"id":"64ad5ce4fddb4e9896c92e73fd58e2d8","name":"修改前合同比对","actionId":"contract_replacehistorycontent","functionId":"","key":"history"},{"id":"ab9be7d21d604749b19e41a6205b1ca2","actionId":"contract_other_comparison","functionId":"","name":"其他文件比对","key":"other"}],"tagStyle":"{display:'inline-block',marginLeft:'4px'}","displayField":"value","title":"$${CTC.button.contractComparison}","icon":"down","type":"default","id":"c0f14154163340a1b1e6d7c9df4476ff","description":"合同比对","propType":"DropdownButtonHook","isTitleChange":false}}
```
</s1>"
"<s1>Human:RDC中页面:列表 组件名称:DropdownButtonHook 业务名称: "EXCEL导入模板",B下拉按钮 组件,元属性/元数据怎么编写？</s1>
<s1>Assisnt:元数据内容如下:
```
{"type":"DropdownButtonHook","property":{"size":"default","enabled":true,"componentTypeName":"","dataSource":"[\r\n    {\r\n        val: '列表导入模板',//列表导入模板\r\n        key: 1\r\n    },\r\n    {\r\n        val: '明细导入模板',//明细导入模板\r\n        key: 2\r\n    },\r\n]\r\n\r\n","subscribes":[{"event":"cac4450e18b74a138ccbced6474d31fd.onClick","pubs":[{"event":"","eventPayloadExpression":"console.log(\"选中-----\", eventPayload)\r\nlet templateCode = eventPayload==1?'pec_cgd':'pec_cgd_detail'\r\nvar formdata = { 'templateCode': templateCode }\r\nvar dataSource = {\r\n    method: \"post\",\r\n    type: \"api\",\r\n    serverName: \"mdconsole\",\r\n    url: \"/import/template/exporttemplate\",\r\n    body: JSON.stringify(formdata)\r\n  };\r\n  resolveDataSource({dataSource: dataSource, isForm: true, isContentType: false, isReturnResponse: true}).then((response) => {\r\n    response.blob().then((blob) =>{\r\n      let a = document.createElement('a');\r\n      let url = window.URL.createObjectURL(blob);\r\n      a.href = url;\r\n      let fileName = '模板.xls';\r\n      if (response.headers.get('content-disposition')) {\r\n        fileName = window.decodeURIComponent(response.headers.get('content-disposition').split('=')[1], 'UTF-8')\r\n      }\r\n      a.download = fileName;\r\n      a.click();\r\n      window.URL.revokeObjectURL(url);\r\n    })\r\n  });"}]}],"theme":"","valueField":"key","styleType":"1","border":"all","ghost":false,"visible":true,"actionList":[{"id":"3dd61e578199417fb62459f6a6355654","actionId":"purchaseorder_save","functionId":"","key":"1","name":"列表导入模板"},{"id":"ea7fe62ecda049dc9d22c0e9a1de01bf","actionId":"purchaseorder_save","functionId":"","key":"2","name":"明细导入模板"}],"tagStyle":"{display:'inline-block',marginLeft:'4px'}","displayField":"val","title":"$${label.excelTemplate}","icon":"down","type":"default","id":"cac4450e18b74a138ccbced6474d31fd","description":"EXCEL导入模板","propType":"DropdownButtonHook","isTitleChange":false}}
```
</s1>"
"<s1>Human:RDC中页面:送货排程-列表页 组件名称:DropdownButtonHook 业务名称: "要货计划",B下拉按钮 组件,元属性/元数据怎么编写？</s1>
<s1>Assisnt:元数据内容如下:
```
{"type":"DropdownButtonHook","property":{"size":"default","enabled":true,"componentTypeName":"","dataSource":"[\r\n    {\r\n        value: '$${moduleCode.YHJH}',//要货计划\r\n        code: 1\r\n    },\r\n    {\r\n        value: '$${Common.label.purchaseorder}',//采购订单\r\n        code: 2\r\n    },\r\n]\r\n\r\n","subscribes":[{"event":"8eec16e5d88c4311b865fe82de1f5e89.onClick","pubs":[{"event":"","eventPayloadExpression":"console.log(\"选中-----\", eventPayload)\r\nresolveFetch({fetch:{id: \"1e3448a4d7584effa76824d7b0cf3d64\",data:\"@@formValues\"}}).then(function(result){\r\n    let nowTime = new Date().getTime(), weekDay = new Date().getDay(),oneDayTime = 24 * 60 * 60 * 1000;\r\n    let thisWeekMondayTime = (1 - weekDay) * oneDayTime + nowTime;\r\n    if (weekDay == 0) {\r\n        // weekDay = 0 为周日，此时本周一时间为周日减去6天的时间\r\n        thisWeekMondayTime = nowTime - 6 * oneDayTime\r\n    }\r\n    let startTime = moment(new Date(thisWeekMondayTime)).format(\"YYYY-MM-DD\");\r\n    let endTime = getRecentDay(thisWeekMondayTime,13);\r\n    delete result.begDemandDate\r\n    delete result.endDemandDate\r\n    delete result.endDeliveryDate\r\n    delete result.begDeliveryDate\r\n    delete result['purchasingOrgCode&purchasingOrgName']\r\n    delete result['companyCode&companyName']\r\n    delete result['plantCode&plantName']\r\n    delete result['materialCode&materialName']\r\n    delete result['vendorErpCode&vendorName']\r\n    delete result['status']\r\n    delete result['purPlanNo']\r\n    delete result['sourceNo']\r\n    delete result['scheduleSplitBy']\r\n    \r\n    result['independentSearch_dateScope'] = \"002\"\r\n    result.startTime = startTime\r\n    result.endTime = endTime\r\n    pubsub.publish(\"@@form.init\", {\r\n        id:\"1e3448a4d7584effa76824d7b0cf3d64\",\r\n        data:result\r\n    });\r\n    \r\n\r\n    if (eventPayload == 1) {\r\n        //来源要货计划看板\r\n        pubsub.publish(\"f508cbe9aa024ba4b0a70c0e7399aa42.displayIndex\", 1)\r\n        pubsub.publish(\"ca17963b925d4db4b93679be49edbc7f.displayIndex\", 1) //看板高级搜索\r\n        // pubsub.publish(\"1e3448a4d7584effa76824d7b0cf3d64.setTableHeader\",{type:'YHJH'})\r\n        pubsub.publish('4b3b49c65e6b43249de0b4b6f8b5eaa4.visible',false)\r\n        pubsub.publish('8eec16e5d88c4311b865fe82de1f5e89.visible',true)\r\n        pubsub.publish('2130fc5901dc41309282090a6bd4df83.visible',false)\r\n        // pubsub.publish(\"@@form.change\", {\r\n        //     id:\"1e3448a4d7584effa76824d7b0cf3d64\",\r\n        //     name:\"independentSearch_dateScope\",\r\n        //     value:\"002\"\r\n        // });\r\n    } else {\r\n        //来源采购订单看板\r\n        pubsub.publish(\"f508cbe9aa024ba4b0a70c0e7399aa42.displayIndex\", 2)\r\n        pubsub.publish(\"ca17963b925d4db4b93679be49edbc7f.displayIndex\", 2) //看板高级搜索\r\n        // pubsub.publish(\"1e3448a4d7584effa76824d7b0cf3d64.setTableHeader\",{type:'CGD'})\r\n        pubsub.publish('4b3b49c65e6b43249de0b4b6f8b5eaa4.visible',true)\r\n        pubsub.publish('8eec16e5d88c4311b865fe82de1f5e89.visible',false)\r\n        pubsub.publish('2130fc5901dc41309282090a6bd4df83.visible',true)\r\n        // pubsub.publish(\"@@form.change\", {\r\n        //     id:\"1e3448a4d7584effa76824d7b0cf3d64\",\r\n        //     name:\"independentSearch_dateScope\",\r\n        //     value:\"002\"\r\n        // });\r\n    }\r\n\r\n//近多少天的开始时间\r\nfunction getRecentDay(startTime,n) {\r\n    let day = moment(new Date(startTime)).subtract(-n, \"days\").format(\"YYYY-MM-DD\");\r\n    return day;\r\n}\r\n    \r\n});"}]}],"theme":"","valueField":"code","styleType":"1","border":"all","ghost":false,"visible":true,"actionList":[],"tagStyle":"{display:'inline-block',marginLeft:'4px'}","displayField":"value","title":"$${moduleCode.YHJH}","icon":"down","type":"default","id":"8eec16e5d88c4311b865fe82de1f5e89","description":"要货计划","propType":"DropdownButtonHook","isTitleChange":false}}
```
</s1>"
"<s1>Human:RDC中页面:送货排程-列表页 组件名称:DropdownButtonHook 业务名称: "采购订单",B下拉按钮 组件,元属性/元数据怎么编写？</s1>
<s1>Assisnt:元数据内容如下:
```
{"type":"DropdownButtonHook","property":{"size":"default","enabled":true,"componentTypeName":"","dataSource":"[\r\n    {\r\n        value: '$${moduleCode.YHJH}',//要货计划\r\n        code: 1\r\n    },\r\n    {\r\n        value: '$${Common.label.purchaseorder}',//采购订单\r\n        code: 2\r\n    },\r\n]\r\n\r\n","subscribes":[{"event":"2130fc5901dc41309282090a6bd4df83.onClick","pubs":[{"event":"","eventPayloadExpression":"console.log(\"选中-----\", eventPayload)\r\nresolveFetch({fetch:{id: \"1e3448a4d7584effa76824d7b0cf3d64\",data:\"@@formValues\"}}).then(function(result){\r\n    let nowTime = new Date().getTime(), weekDay = new Date().getDay(),oneDayTime = 24 * 60 * 60 * 1000;\r\n    let thisWeekMondayTime = (1 - weekDay) * oneDayTime + nowTime;\r\n    if (weekDay == 0) {\r\n        // weekDay = 0 为周日，此时本周一时间为周日减去6天的时间\r\n        thisWeekMondayTime = nowTime - 6 * oneDayTime\r\n    }\r\n    let startTime = moment(new Date(thisWeekMondayTime)).format(\"YYYY-MM-DD\");\r\n    let endTime = getRecentDay(thisWeekMondayTime,13);\r\n    delete result.begDemandDate\r\n    delete result.endDemandDate\r\n    delete result.endDeliveryDate\r\n    delete result.begDeliveryDate\r\n    delete result['purchasingOrgCode&purchasingOrgName']\r\n    delete result['companyCode&companyName']\r\n    delete result['plantCode&plantName']\r\n    delete result['materialCode&materialName']\r\n    delete result['vendorErpCode&vendorName']\r\n    delete result['status']\r\n    delete result['purPlanNo']\r\n    delete result['sourceNo']\r\n    result['independentSearch_dateScope'] = \"002\"\r\n    result.startTime = startTime\r\n    result.endTime = endTime\r\n    pubsub.publish(\"@@form.init\", {\r\n        id:\"1e3448a4d7584effa76824d7b0cf3d64\",\r\n        data:result\r\n    });\r\n    \r\n\r\n    if (eventPayload == 1) {\r\n        //来源要货计划看板\r\n        pubsub.publish(\"f508cbe9aa024ba4b0a70c0e7399aa42.displayIndex\", 1)\r\n        pubsub.publish(\"ca17963b925d4db4b93679be49edbc7f.displayIndex\", 1) //看板高级搜索\r\n        // pubsub.publish(\"1e3448a4d7584effa76824d7b0cf3d64.setTableHeader\",{type:'YHJH'})\r\n        pubsub.publish('4b3b49c65e6b43249de0b4b6f8b5eaa4.visible',false)\r\n        pubsub.publish('8eec16e5d88c4311b865fe82de1f5e89.visible',true)\r\n        pubsub.publish('2130fc5901dc41309282090a6bd4df83.visible',false)\r\n        // pubsub.publish(\"@@form.change\", {\r\n        //     id:\"1e3448a4d7584effa76824d7b0cf3d64\",\r\n        //     name:\"independentSearch_dateScope\",\r\n        //     value:\"002\"\r\n        // });\r\n    } else {\r\n        //来源采购订单看板\r\n        pubsub.publish(\"f508cbe9aa024ba4b0a70c0e7399aa42.displayIndex\", 2)\r\n        pubsub.publish(\"ca17963b925d4db4b93679be49edbc7f.displayIndex\", 2) //看板高级搜索\r\n        // pubsub.publish(\"1e3448a4d7584effa76824d7b0cf3d64.setTableHeader\",{type:'CGD'})\r\n        pubsub.publish('4b3b49c65e6b43249de0b4b6f8b5eaa4.visible',true)\r\n        pubsub.publish('8eec16e5d88c4311b865fe82de1f5e89.visible',false)\r\n        pubsub.publish('2130fc5901dc41309282090a6bd4df83.visible',true)\r\n        // pubsub.publish(\"@@form.change\", {\r\n        //     id:\"1e3448a4d7584effa76824d7b0cf3d64\",\r\n        //     name:\"independentSearch_dateScope\",\r\n        //     value:\"002\"\r\n        // });\r\n    }\r\n\r\n//近多少天的开始时间\r\nfunction getRecentDay(startTime,n) {\r\n    let day = moment(new Date()).subtract(-n, \"days\").format(\"YYYY-MM-DD\");\r\n    return day;\r\n}\r\n    \r\n});"}]}],"theme":"","valueField":"code","styleType":"1","border":"all","ghost":false,"visible":false,"actionList":[],"tagStyle":"{display:'inline-block',marginLeft:'4px'}","displayField":"value","title":"$${Common.label.purchaseorder}","icon":"down","type":"default","id":"2130fc5901dc41309282090a6bd4df83","description":"采购订单","propType":"DropdownButtonHook","isTitleChange":false}}
```
</s1>"
"<s1>Human:RDC中页面:ECN-列表 组件名称:DropdownButtonHook 业务名称: "EXCEL模板下载",B下拉按钮 组件,元属性/元数据怎么编写？</s1>
<s1>Assisnt:元数据内容如下:
```
{"property":{"size":"default","enabled":true,"componentTypeName":"","dataSource":"[{\r\n    key: '0',\r\n    val: '$${button.relation}',\r\n    enabled: true\r\n}, {\r\n    key: '1',\r\n    val: '$${label.associatedOrder}',\r\n    enabled: true\r\n}]","subscribes":[{"pubs":[{"event":"","eventPayloadExpression":"var templateCode\r\nif (eventPayload == '0') {\r\n    templateCode = 'pec_projectChangeEcnVendor'\r\n} else if (eventPayload == '1') {\r\n    templateCode = 'pec_projectChangeEcnPoDtl'\r\n}\r\nvar formdata = { 'templateCode': templateCode }\r\nvar dataSource = {\r\n    method: \"post\",\r\n    type: \"api\",\r\n    serverName: \"mdconsole\",\r\n    url: \"/import/template/exporttemplate\",\r\n    body: JSON.stringify(formdata)\r\n};\r\nresolveDataSource({ dataSource: dataSource, isForm: true, isContentType: false, isReturnResponse: true }).then((response) => {\r\n    response.blob().then((blob) => {\r\n        let a = document.createElement('a');\r\n        let url = window.URL.createObjectURL(blob);\r\n        a.href = url;\r\n        let fileName = '模板.xls';\r\n        if (response.headers.get('content-disposition')) {\r\n            fileName = window.decodeURIComponent(response.headers.get('content-disposition').split('=')[1], 'UTF-8')\r\n        }\r\n        a.download = fileName;\r\n        a.click();\r\n        window.URL.revokeObjectURL(url);\r\n    })\r\n});"}],"event":"9d9f708fe03347f0ab3326f49652274f.onClick"}],"theme":"","valueField":"key","styleType":"1","border":"all","ghost":false,"visible":true,"actionList":[{"id":"e05f55e3a1534feaa3a4c3abe866dc6a","key":"0","name":"$${button.relation}","actionId":"pecprojectchangeecn_save","functionId":""},{"id":"646a11aaaee240e48f319fbedea5f9ea","key":"1","name":"$${label.associatedOrder}","actionId":"pecprojectchangeecn_save","functionId":""}],"tagStyle":"{display:'inline-block',marginLeft:'4px'}","displayField":"val","title":"EXCEL$${button.download}","icon":"down","type":"default","id":"9d9f708fe03347f0ab3326f49652274f","description":"EXCEL模板下载","propType":"DropdownButtonHook","isTitleChange":false},"type":"DropdownButtonHook"}
```
</s1>"
"<s1>Human:RDC中页面:转订单 组件名称:DropdownButtonHook 业务名称: "快速填充",B下拉按钮 组件,元属性/元数据怎么编写？</s1>
<s1>Assisnt:元数据内容如下:
```
{"property":{"size":"default","enabled":true,"componentTypeName":"","dataSource":"[\r\n    {\r\n        value: '$${porder.orderType}',//采购订单类型\r\n        code: 1\r\n    },\r\n    // {\r\n    //     value: '$${factory}',//工厂\r\n    //     code: 2\r\n    // },\r\n    {\r\n        value: '$${label.stockLocation}',//库存地点\r\n        code: 3\r\n    },\r\n    // {\r\n    //     value: '$${label.quality.materialGroup}',//物料组\r\n    //     code: 4\r\n    // },\r\n    {\r\n        value: '$${label.deliveryDate}',//交货日期\r\n        code: 5\r\n    },\r\n    {\r\n        value: '$${PEC.label.deliveryDateNDays}',//交货日期提前N天\r\n        code: 6\r\n    },\r\n    {\r\n        value: '$${Common.label.restoreOriginalValue}',//恢复原值\r\n        code: 7\r\n    }\r\n]\r\n\r\n","subscribes":[{"pubs":[{"event":"","eventPayloadExpression":"console.log(\"选中-----\", eventPayload)\r\n//1: 采购订单类型、2: 工厂、3: 库存地点、4: 物料组、5: 交货日期、6: 交货日期提前N天、7: 恢复原值\r\nif (eventPayload == 7) {//恢复原值\r\n    resolveFetch({ fetch: { id: \"cf375ddab354466cb91ff2fdbb5c09a2\", data: \"@@formValues\" } }).then(function (result) {\r\n        console.log(\"页面初始化---\", result)\r\n        pubsub.publish(\"cf375ddab354466cb91ff2fdbb5c09a2.openM\", {\r\n            id: \"932b45fe0c384ba88f21771a21d59f39\",\r\n            width: \"small\",\r\n            title: \"$${Common.label.restoreOriginalValue}\",//恢复原值\r\n            data: result.dtlTemp\r\n        });\r\n    });\r\n} else {\r\n    // 需选中行明细，否则报错提示\r\n    resolveFetch({ fetch: { id: \"98b269d6be56452097f9d738a47facfb\", data: \"selectedRows\" } }).then(function (selectRowItem) {\r\n        console.log(\"选中行数据00000\", selectRowItem, eventPayload)\r\n        if (selectRowItem.length > 0) {\r\n            selectRowItem.forEach(item => {\r\n                item.quickFillFlag = eventPayload\r\n            })\r\n\r\n            if (eventPayload == 1) { //采购订单类型\r\n                var valueArr = selectRowItem.map(function (it) { return it.purchaseCategory });\r\n                const arr = [...new Set(valueArr)]\r\n                if (arr.length > 1 && selectRowItem.length >= 2) {\r\n                    pubsub.publish(\"@@message.error\", '$${PEC.tip.selectDetailsSamePurchaseCategory}');//您选中的数据中存在不同 “采购类别”的数据，因采购订单类型和采购类别有控制关系，请选择相同“采购类别”的明细信息\r\n                    return\r\n                }\r\n            }\r\n            if (eventPayload == 2) {//工厂\r\n                let arr = []\r\n                selectRowItem.forEach((item) => {\r\n                    arr.push(item.plantCode)\r\n                })\r\n                if (arr.filter(item => item != undefined && item != '').length > 0) {\r\n                    pubsub.publish(\"@@message.error\", '$${PEC.tip.selectPlantNotEmpty}');//您选中的明细信息中存在“工厂”不为空的数据，请重新选择！\r\n                    return\r\n                }\r\n                var valueArr = selectRowItem.map(function (it) { return it.demandPool.companyCode });\r\n                var isDuplicate = valueArr.some(function (it, idx) {\r\n                    return valueArr.indexOf(it) != idx\r\n                });\r\n                if (!isDuplicate && selectRowItem.length >= 2) {\r\n                    pubsub.publish(\"@@message.error\", '$${PEC.tip.selectCompanySame}');//您选中的明细信息中存在不同“公司”的数据，因公司和工厂有控制关系，请选择相同“公司”的明细信息！\r\n                    return\r\n                }\r\n            }\r\n            if (eventPayload == 3) {//库存地点\r\n                var valueArr = selectRowItem.map(function (it) { return it.plantCode });\r\n                var isDuplicate = valueArr.some(function (it, idx) {\r\n                    return valueArr.indexOf(it) != idx\r\n                });\r\n                if (!isDuplicate && selectRowItem.length >= 2) {\r\n                    pubsub.publish(\"@@message.error\", '$${PEC.tip.selectPlantSameEmpty}');//您选中的明细信息中存在不同“工厂”的数据，因工厂和库存地点有控制关系，请选择相同“工厂”的明细信息！\r\n                    return\r\n                }\r\n            }\r\n            if (eventPayload == 4) {//物料组\r\n                let arr = []\r\n                selectRowItem.forEach((item) => {\r\n                    arr.push(item.demandPool.materialCode)\r\n                })\r\n                console.log(\"物料组\", arr)\r\n                if (arr.filter(item => item != undefined && item != '').length > 0) {\r\n                    pubsub.publish(\"@@message.error\", '$${PEC.tip.selectMaterialCodeNotEmpty}');//您选中的明细信息中存在“物料编码”不为空的数据，请重新选择！\r\n                    return\r\n                }\r\n                // if (arr.some(val => val === '')) {\r\n                //     pubsub.publish(\"@@message.error\", '$${PEC.tip.selectMaterialCodeNotEmpty}');//您选中的明细信息中存在“物料编码”不为空的数据，请重新选择！\r\n                //     return\r\n                // }\r\n            }\r\n\r\n            pubsub.publish(\"cf375ddab354466cb91ff2fdbb5c09a2.openM\", {\r\n                id: \"833387feea97422bbcc3f8f58173c241\",\r\n                width: \"small\",\r\n                title: \"$${label.quickFill}\",//快速填充\r\n                data: selectRowItem\r\n            });\r\n        } else {\r\n            pubsub.publish(\"@@message.error\", \"$${PEC.tip.pleasecheckDetailsAndClickBtnAgain}\");//请勾选明细信息，再点击此按钮!\r\n        }\r\n    });\r\n}\r\n"}],"event":"dae28716fc1d44898b00840ee7a57f56.onClick"}],"theme":"","valueField":"code","styleType":"1","border":"all","ghost":false,"visible":true,"actionList":[],"tagStyle":"{display:'inline-block',marginLeft:'4px'}","displayField":"value","title":"$${label.quickFill}","icon":"down","type":"default","id":"dae28716fc1d44898b00840ee7a57f56","description":"快速填充","propType":"DropdownButtonHook","isTitleChange":false},"type":"DropdownButtonHook"}
```
</s1>"
"<s1>Human:RDC中页面:新建/编辑配置 组件名称:DropdownButtonHook 业务名称: "别名",B下拉按钮 组件,元属性/元数据怎么编写？</s1>
<s1>Assisnt:元数据内容如下:
```
{"property":{"border":"all","subscribes":[],"visible":true,"tagStyle":"{display:'inline-block',marginLeft:'4px'}","icon":"down","actionList":[],"description":"别名","valueField":"key","title":"启用/停用","type":"default","enabled":true,"styleType":"1","anchorTarget":false,"ghost":false,"size":"default","displayField":"val","isTitleChange":false,"theme":"","id":"3e09e81febf24bba926e0769e792168f","propType":"DropdownButtonHook","dataSource":"[{ key: \"1\", val: \"启用\", enabled: true }, { key: \"0\", val: \"禁用\", enabled: true }]"},"type":"DropdownButtonHook"}
```
</s1>"
